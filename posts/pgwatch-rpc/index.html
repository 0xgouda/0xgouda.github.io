<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>pgwatch RPC | Ahmed's DevLog</title><meta name=keywords content="postgresql,gsoc"><meta name=description content="PostgreSQL GSoC Acceptance
After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow & resolve bugs i have been accepted at PostgreSQL&rsquo;s GSoC'25 program!!, And here i will be sketching the outline of my Enhancements to pgwatch v3 rpc integration proposal deliverables.
pgwatch RPC integration
Pgwatch is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, Pgwatch Docs."><meta name=author content="Ahmed Gouda"><link rel=canonical href=https://0xgouda.github.io/posts/pgwatch-rpc/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://0xgouda.github.io/my-icon.png><link rel=icon type=image/png sizes=16x16 href=https://0xgouda.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0xgouda.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://0xgouda.github.io/apple-touch-icon.png><link rel=mask-icon href=https://0xgouda.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://0xgouda.github.io/posts/pgwatch-rpc/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://0xgouda.github.io/posts/pgwatch-rpc/"><meta property="og:site_name" content="Ahmed's DevLog"><meta property="og:title" content="pgwatch RPC"><meta property="og:description" content="PostgreSQL GSoC Acceptance After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow & resolve bugs i have been accepted at PostgreSQL’s GSoC'25 program!!, And here i will be sketching the outline of my Enhancements to pgwatch v3 rpc integration proposal deliverables.
pgwatch RPC integration Pgwatch is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, Pgwatch Docs."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-12T16:44:04+03:00"><meta property="article:modified_time" content="2025-05-12T16:44:04+03:00"><meta property="article:tag" content="Postgresql"><meta property="article:tag" content="Gsoc"><meta name=twitter:card content="summary"><meta name=twitter:title content="pgwatch RPC"><meta name=twitter:description content="PostgreSQL GSoC Acceptance
After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow & resolve bugs i have been accepted at PostgreSQL&rsquo;s GSoC'25 program!!, And here i will be sketching the outline of my Enhancements to pgwatch v3 rpc integration proposal deliverables.
pgwatch RPC integration
Pgwatch is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, Pgwatch Docs."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://0xgouda.github.io/posts/"},{"@type":"ListItem","position":2,"name":"pgwatch RPC","item":"https://0xgouda.github.io/posts/pgwatch-rpc/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"pgwatch RPC","name":"pgwatch RPC","description":"PostgreSQL GSoC Acceptance After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow \u0026amp; resolve bugs i have been accepted at PostgreSQL\u0026rsquo;s GSoC'25 program!!, And here i will be sketching the outline of my Enhancements to pgwatch v3 rpc integration proposal deliverables.\npgwatch RPC integration Pgwatch is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, Pgwatch Docs.\n","keywords":["postgresql","gsoc"],"articleBody":"PostgreSQL GSoC Acceptance After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow \u0026 resolve bugs i have been accepted at PostgreSQL’s GSoC'25 program!!, And here i will be sketching the outline of my Enhancements to pgwatch v3 rpc integration proposal deliverables.\npgwatch RPC integration Pgwatch is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, Pgwatch Docs.\nour focus here is on the data exporting options, pgwatch has builtin support for exporting data to postgres (and its flavours), prometheus and json. for sure this won’t be enough to all users, so they added an RPC client that can send the data to a server which is then responsible of routing thayt data to the user’s desired data solution.\nAnd an implementation of an RPC server that integrates with pgwatch has been developed pgwatch3_rpc_server, it tries to provide support for the most common data solutions and formats, but it mainly serves as a template or a tutorial on how to integrate with pgwatch RPC so users can find it easy to develop their own custom RPC sinks.\nAnd now some more enhancements are required to be added to this pgwatch3_rpc_server, which include:\nProvide an authentication protocol for the current RPC implementation Add support for TLS to protect auth keys and data sent Improve Architecture Additional sink implementations Improved developer experience for building custom sinks Outline Improved Architecture\nAll the codebase especially shared logic or repeated code will be defined in functions/interfaces to make the codebase more modular ​Authentication\nupdate pgwatch3 client has to send api keys with each RPC call On receiver running it generates a robust api key and saves it to a file with strict permissions The client copies the key and then Sends it with the parameters passed to the RPC function The Server then uses a middleware function to Validate the api key parameter before processing the RPC call On the receiver rerunning it overwrites the file invalidating the api key TLS \u0026 HTTPs\nupdate pgwatch3 client has to connect via TLS On receiver running it runs a shell script that uses openssl to generate self-signed certificates and keys Create a new tls listener and use the certificate/keys to encrypt the connection ​ ​Sink Template\nCreate a template receiver with only sink logic interfaces left to the user to implement with clear inline comments \u0026 README file to guide the developer how to implement those interfaces Note: we are still rethinking other options to improve sinks development experience for users any suggestions are welcomed Additional Sinks\nimplement more data sinks that both covers highly used solutions and improves the variety of the existing examples AWS Cloudwatch -\u003e AWS’s metrics analytics solution ElasticSearch -\u003e Search and analytics engine Splunk -\u003e Security and event-management solution MongoDB -\u003e NoSql Flexible Schema logging Azure log analytics -\u003e Azure’s log analytics solution Google cloud pub/sub -\u003e Google’s messaging \u0026 event streaming solution …more Flow chart ","wordCount":"516","inLanguage":"en","datePublished":"2025-05-12T16:44:04+03:00","dateModified":"2025-05-12T16:44:04+03:00","author":{"@type":"Person","name":"Ahmed Gouda"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0xgouda.github.io/posts/pgwatch-rpc/"},"publisher":{"@type":"Organization","name":"Ahmed's DevLog","logo":{"@type":"ImageObject","url":"https://0xgouda.github.io/my-icon.png"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://0xgouda.github.io/ accesskey=h title="Ahmed's DevLog (Alt + H)">Ahmed's DevLog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://0xgouda.github.io/posts/ title=Blog><span>Blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://0xgouda.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://0xgouda.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">pgwatch RPC</h1><div class=post-meta><span title='2025-05-12 16:44:04 +0300 +0300'>May 12, 2025</span>&nbsp;·&nbsp;Ahmed Gouda</div></header><div class=post-content><h2 id=postgresql-gsoc-acceptance>PostgreSQL GSoC Acceptance<a hidden class=anchor aria-hidden=true href=#postgresql-gsoc-acceptance>#</a></h2><p>After a long journey of searching projects, interacting with the community and starring at the codebase late night trying to understand the workflow & resolve bugs i have been <a href=https://summerofcode.withgoogle.com/programs/2025/projects/4Be9mT3p>accepted</a> at <strong>PostgreSQL&rsquo;s GSoC'25 program</strong>!!, And here i will be sketching the outline of my <strong>Enhancements to pgwatch v3 rpc integration</strong> proposal deliverables.</p><h2 id=pgwatch-rpc-integration>pgwatch RPC integration<a hidden class=anchor aria-hidden=true href=#pgwatch-rpc-integration>#</a></h2><p><a href=https://github.com/cybertec-postgresql/pgwatch>Pgwatch</a> is PostgreSQL servers monitoring solution, it has an embedded grafana dashboard, built with scale in mind where a single instance can monitor thousands of servers and many other features, <a href=https://pgwat.ch>Pgwatch Docs</a>.</p><p>our focus here is on the data exporting options, pgwatch has builtin support for exporting data to postgres (and its flavours), prometheus and json. for sure this won&rsquo;t be enough to all users, so they added an RPC client that can send the data to a server which is then responsible of routing thayt data to the user&rsquo;s desired data solution.</p><p>And an implementation of an RPC server that integrates with pgwatch has been developed <a href=https://github.com/destrex271/pgwatch3_rpc_server>pgwatch3_rpc_server</a>, it tries to provide support for the most common data solutions and formats, but it mainly serves as a template or a tutorial on how to integrate with pgwatch RPC so users can find it easy to develop their own custom RPC sinks.</p><p>And now some more enhancements are required to be added to this pgwatch3_rpc_server, which include:</p><ol><li>Provide an authentication protocol for the current RPC implementation</li><li>Add support for TLS to protect auth keys and data sent</li><li>Improve Architecture</li><li>Additional sink implementations</li><li>Improved developer experience for building custom sinks</li></ol><h3 id=outline>Outline<a hidden class=anchor aria-hidden=true href=#outline>#</a></h3><ol><li><p>Improved Architecture</p><ul><li>All the codebase especially shared logic or repeated code will be defined in functions/interfaces to make the codebase more modular</li></ul></li><li><p>​Authentication</p><ul><li>update pgwatch3 client has to send api keys with each RPC call</li><li>On receiver running it generates a robust api key and saves it to a file with strict permissions</li><li>The client copies the key and then Sends it with the parameters passed to the RPC function</li><li>The Server then uses a middleware function to Validate the api key parameter before processing the RPC call</li><li>On the receiver rerunning it overwrites the file invalidating the api key</li></ul></li><li><p>TLS & HTTPs</p><ul><li>update pgwatch3 client has to connect via TLS</li><li>On receiver running it runs a shell script that uses openssl to generate self-signed certificates and keys</li><li>Create a new tls listener and use the certificate/keys to encrypt the connection ​</li></ul></li><li><p>​Sink Template</p><ul><li>Create a template receiver with only sink logic interfaces left to the user to implement with clear inline comments & README file to guide the developer how to implement those interfaces</li><li>Note: we are still rethinking other options to improve sinks development experience for users any suggestions are welcomed</li></ul></li><li><p>Additional Sinks</p><ul><li>implement more data sinks that both covers highly used solutions and improves the variety of the existing examples</li></ul><ol><li>AWS Cloudwatch -> AWS’s metrics analytics solution</li><li>ElasticSearch -> Search and analytics engine</li><li>Splunk -> Security and event-management solution</li><li>MongoDB -> NoSql Flexible Schema logging</li><li>Azure log analytics -> Azure’s log analytics solution</li><li>Google cloud pub/sub -> Google’s messaging & event streaming solution</li><li>&mldr;more</li></ol></li></ol><h3 id=flow-chart>Flow chart<a hidden class=anchor aria-hidden=true href=#flow-chart>#</a></h3><p><img alt="Flow Chart" loading=lazy src=/assets/images/Flowchart.jpg></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://0xgouda.github.io/tags/postgresql/>Postgresql</a></li><li><a href=https://0xgouda.github.io/tags/gsoc/>Gsoc</a></li></ul><nav class=paginav><a class=prev href=https://0xgouda.github.io/posts/my-postgresql-gsoc25-journey/><span class=title>« Prev</span><br><span>My Postgresql GSoC'25 Journey</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://0xgouda.github.io/>Ahmed's DevLog</a></span> ·
<span><a href=https://github.com/0xgouda rel=noopener target=_blank>Github</a> |
<a href=https://www.linkedin.com/in/ahmed-gouda-1462b022b rel="noopener noreferrer" target=_blank>LinkedIn</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>